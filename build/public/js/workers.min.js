"use strict";var posList=document.querySelector(".collection"),delAction="/Workers/deleteWorker/",showAction="/Workers/echoWorkers/",tableHeader=document.getElementById("tbl-header").innerHTML,showParams="",sortNameBtn="",sortSnameBtn="",sortPosBtn="",sortSalBtn="";function viewPosition(e){var t=document.getElementById("upd-name"),n=document.getElementById("upd-sur-name"),a=document.getElementById("upd-pos"),o=document.getElementById("upd-slr"),s=document.getElementById("upd-desc"),r=document.getElementById("upd-id"),d=urlRoot+"/Workers/echoWorker/"+e,u=new XMLHttpRequest;u.open("GET",d,!0),u.onreadystatechange=function(){if(4==u.readyState&&200==u.status){var e=JSON.parse(u.responseText);t.value=e.name,n.value=e.surname,a.value=e.position_id,o.value=e.salary,s.value=e.Characteristics,r.value=e.id}},u.send(d)}function addWorker(e,t,n,a,o){var s=urlRoot+"/Workers/addWorker/"+e+"/"+t+"/\n  "+n+"/"+a+"/"+o;ajaxGet(s)}function updateWorker(e,t,n,a,o,s){var r=urlRoot+"/Workers/updateWorker/"+e+"/"+t+"/"+n+"/"+a+"/"+o+"/"+s;ajaxGet(r)}function SortButtonsStatus(e,t){document.getElementById("tbl-header").innerHTML=tableHeader;var n="",a="";switch("DESC"==e?(n="fa fa-caret-down",a="btn-info"):(n="fa fa-caret-up",a="btn-warning"),t){case"name":document.getElementById("name-btn").innerHTML='Имя <button class="btn '+a+' btn-sm" onclick="sort(\'name\')">\n    <i class="'+n+'"></i></button>';break;case"sname":document.getElementById("sur-name-btn").innerHTML='Фамилия <button class="btn '+a+' btn-sm" onclick="sort(\'sname\')">\n     <i class="'+n+'"></i></button>';break;case"pos":document.getElementById("pos-btn").innerHTML='Должность <button class="btn '+a+' btn-sm" onclick="sort(\'pos\')">\n    <i class="'+n+'"></i></button>';break;case"sal":document.getElementById("salary-btn").innerHTML='З/п <button class="btn '+a+' btn-sm" onclick="sort(\'sal\')">\n    <i class="'+n+'"></i></button>'}}function btnSwitch(e){switch(e){case"":return"DESC";case"DESC":return"ASC";case"ASC":return"DESC"}}function sort(e){switch(e){case"name":SortButtonsStatus(sortNameBtn=btnSwitch(sortNameBtn),e),showParams=sortNameBtn+"/name";break;case"sname":SortButtonsStatus(sortSnameBtn=btnSwitch(sortSnameBtn),"sname"),showParams=sortSnameBtn+"/surname";break;case"pos":SortButtonsStatus(sortPosBtn=btnSwitch(sortPosBtn),"pos"),showParams=sortPosBtn+"/position.pos_name";break;case"sal":SortButtonsStatus(sortSalBtn=btnSwitch(sortSalBtn),"sal"),showParams=sortSalBtn+"/salary"}showPositions()}function allFieldsOk(e){return!!(checked(e[0],lettersOnlyPattern)&&checked(e[1],lettersOnlyPattern)&&checked(e[2],moneyPattern))}function serverCheck(e){var t=void 0,n=void 0,a=void 0,o=void 0,s=void 0,r=void 0;e?(t=document.getElementById("wrkr-name").value,a=document.getElementById("wrkr-sur-name").value,o=document.getElementById("wrkr-pos").value,s=document.getElementById("wrkr-slr").value,r=document.getElementById("wrkr-desc").value):(n=document.getElementById("upd-id").value,t=document.getElementById("upd-name").value,a=document.getElementById("upd-sur-name").value,o=document.getElementById("upd-pos").value,s=document.getElementById("upd-slr").value,r=document.getElementById("upd-desc").value);var d=urlRoot+"/Workers/checkWorker/"+t+"/"+a+"/"+s,u=new XMLHttpRequest;u.open("GET",d,!0),u.onreadystatechange=function(){if(4==u.readyState&&200==u.status)if("ok"==u.responseText)e?addWorker(t,a,o,s,r):updateWorker(n,t,a,o,s,r);else{var d=document.getElementById("server-err");d.classList.contains("d-none")&&d.classList.remove("d-none")}},u.send(d)}document.getElementById("wrkr-name").addEventListener("keyup",function(e){checkOk("add-btn","add-info",addFieldNames)}),document.getElementById("wrkr-sur-name").addEventListener("keyup",function(e){checkOk("add-btn","add-info",addFieldNames)}),document.getElementById("wrkr-slr").addEventListener("keyup",function(e){checkOk("add-btn","add-info",addFieldNames)}),document.getElementById("upd-name").addEventListener("keyup",function(e){checkOk("upd-btn","upd-info",updFieldNames)}),document.getElementById("upd-sur-name").addEventListener("keyup",function(e){checkOk("upd-btn","upd-info",updFieldNames)}),document.getElementById("upd-slr").addEventListener("keyup",function(e){checkOk("upd-btn","upd-info",updFieldNames)});