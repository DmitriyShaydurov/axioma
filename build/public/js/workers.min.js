"use strict";var posList=document.querySelector(".collection"),delAction="/Workers/deleteWorker/",showAction="/Workers/echoWorkers/",tableHeader=document.getElementById("tbl-header").innerHTML,showParams="",sortNameBtn="",sortSnameBtn="",sortPosBtn="",sortSalBtn="";function viewPosition(e){var t=document.getElementById("upd-name"),n=document.getElementById("upd-sur-name"),s=document.getElementById("upd-pos"),a=document.getElementById("upd-slr"),r=document.getElementById("upd-desc"),o=document.getElementById("upd-id"),c=urlRoot+"/Workers/echoWorker/"+e,d=new XMLHttpRequest;d.open("GET",c,!0),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var e=JSON.parse(d.responseText);t.value=e.name,n.value=e.surname,s.value=e.position_id,a.value=e.salary,r.value=e.Characteristics,o.value=e.id}},d.send(c)}function addWorker(){var e=document.getElementById("wrkr-name"),t=document.getElementById("wrkr-sur-name"),n=document.getElementById("wrkr-pos"),s=document.getElementById("wrkr-slr"),a=document.getElementById("wrkr-desc"),r=urlRoot+"/Workers/addWorker/"+e.value+"/"+t.value+"/\n  "+n.value+"/"+s.value+"/"+a.value;ajaxGet(r)}function updateWorker(){var e=document.getElementById("upd-id").value,t=document.getElementById("upd-name").value,n=document.getElementById("upd-sur-name").value,s=document.getElementById("upd-pos").value,a=document.getElementById("upd-slr").value,r=document.getElementById("upd-desc").value,o=urlRoot+"/Workers/updateWorker/"+e+"/"+t+"/"+n+"/"+s+"/"+a+"/"+r;ajaxGet(o)}function SortButtonsStatus(e,t){document.getElementById("tbl-header").innerHTML=tableHeader;var n="",s="";switch("DESC"==e?(n="fa fa-caret-down",s="btn-info"):(n="fa fa-caret-up",s="btn-warning"),t){case"name":document.getElementById("name-btn").innerHTML='Имя <button class="btn '+s+' btn-sm" onclick="sort(\'name\')">\n    <i class="'+n+'"></i></button>';break;case"sname":document.getElementById("sur-name-btn").innerHTML='Фамилия <button class="btn '+s+' btn-sm" onclick="sort(\'sname\')">\n     <i class="'+n+'"></i></button>';break;case"pos":document.getElementById("pos-btn").innerHTML='Должность <button class="btn '+s+' btn-sm" onclick="sort(\'pos\')">\n    <i class="'+n+'"></i></button>';break;case"sal":document.getElementById("salary-btn").innerHTML='З/п <button class="btn '+s+' btn-sm" onclick="sort(\'sal\')">\n    <i class="'+n+'"></i></button>'}}function btnSwitch(e){switch(e){case"":return"DESC";case"DESC":return"ASC";case"ASC":return"DESC"}}function sort(e){switch(e){case"name":SortButtonsStatus(sortNameBtn=btnSwitch(sortNameBtn),e),showParams=sortNameBtn+"/name";break;case"sname":SortButtonsStatus(sortSnameBtn=btnSwitch(sortSnameBtn),"sname"),showParams=sortSnameBtn+"/surname";break;case"pos":SortButtonsStatus(sortPosBtn=btnSwitch(sortPosBtn),"pos"),showParams=sortPosBtn+"/position.pos_name";break;case"sal":SortButtonsStatus(sortSalBtn=btnSwitch(sortSalBtn),"sal"),showParams=sortSalBtn+"/salary"}showPositions()}function checked(e,t){var n=!1,s=document.getElementById(e);return t||""!=s.value?((t?/^[a-z\u017F\u0430-\u044F\u0451\u212A]+$/i:/^[1-9]{1}[\d]*[,]{0,1}\d{0,2}$/).test(s.value)?(n=!0,s.classList.contains("is-invalid")&&s.classList.remove("is-invalid"),s.classList.contains("is-valid")||s.classList.add("is-valid")):s.classList.contains("is-invalid")||(s.classList.add("is-invalid"),n=!1),n):(s.classList.contains("is-invalid")&&(s.classList.remove("is-invalid"),s.classList.add("is-valid")),n=!0)}function checkOk(){var e=document.getElementById("add-btn"),t=document.getElementById("add-info");return checked("wrkr-name",!0)&&checked("wrkr-sur-name",!0)&&checked("wrkr-slr",!1)?(t.classList.remove("bg-info"),t.classList.add("bg-success"),t.innerHTML="Форма готова к отправке",e.classList.remove("d-none"),!0):(t.classList.remove("bg-success"),t.classList.add("bg-info"),t.innerHTML="Для добавления работника корректно заполните форму",e.classList.add("d-none"),!1)}document.getElementById("wrkr-name").addEventListener("keyup",function(e){checked("wrkr-name",!0);checkOk()}),document.getElementById("wrkr-sur-name").addEventListener("keyup",function(e){checked("wrkr-sur-name",!0),checkOk()}),document.getElementById("wrkr-slr").addEventListener("keyup",function(e){checked("wrkr-slr",!1),checkOk()});